{"ast":null,"code":"import * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/router\";\nimport * as i2 from \"../api.service\";\nimport * as i3 from \"src/app/app.tokenservice\";\nimport * as i4 from \"@angular/common\";\nimport * as i5 from \"@angular/forms\";\nfunction ApplicationRequestComponent_div_0_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\")(1, \"h2\", 10);\n    i0.ɵɵtext(2, \"Login to View this Page.\");\n    i0.ɵɵelementEnd()();\n  }\n}\nfunction ApplicationRequestComponent_div_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\")(1, \"h2\", 10);\n    i0.ɵɵtext(2, \"User is not authorised.\");\n    i0.ɵɵelementEnd()();\n  }\n}\nconst _c0 = function (a1) {\n  return [\"/application-request\", a1];\n};\nfunction ApplicationRequestComponent_div_2_tr_20_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r7 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"tr\")(1, \"td\");\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"td\");\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"td\");\n    i0.ɵɵtext(6);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"td\");\n    i0.ɵɵtext(8);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(9, \"td\")(10, \"a\", 18);\n    i0.ɵɵlistener(\"click\", function ApplicationRequestComponent_div_2_tr_20_Template_a_click_10_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r7);\n      const request_r5 = restoredCtx.$implicit;\n      const ctx_r6 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r6.selectRequest(request_r5));\n    });\n    i0.ɵɵtext(11, \"View\");\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const request_r5 = ctx.$implicit;\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(request_r5.username);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(request_r5.officialEmail);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(request_r5.phoneNumber);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(request_r5.companyId);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"routerLink\", i0.ɵɵpureFunction1(5, _c0, request_r5.userId));\n  }\n}\nfunction ApplicationRequestComponent_div_2_div_22_p_11_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"p\");\n    i0.ɵɵtext(1, \"Role : Motorist\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction ApplicationRequestComponent_div_2_div_22_p_12_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"p\");\n    i0.ɵɵtext(1, \"Role : Rider\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction ApplicationRequestComponent_div_2_div_22_p_19_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"p\");\n    i0.ɵɵtext(1, \"No Driving License\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction ApplicationRequestComponent_div_2_div_22_button_20_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"button\", 26);\n    i0.ɵɵtext(1, \" Show Driving License \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction ApplicationRequestComponent_div_2_div_22_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r13 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\")(1, \"h2\");\n    i0.ɵɵtext(2, \"Application Details\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"p\");\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"p\");\n    i0.ɵɵtext(6);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"p\");\n    i0.ɵɵtext(8);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(9, \"p\");\n    i0.ɵɵtext(10);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(11, ApplicationRequestComponent_div_2_div_22_p_11_Template, 2, 0, \"p\", 0);\n    i0.ɵɵtemplate(12, ApplicationRequestComponent_div_2_div_22_p_12_Template, 2, 0, \"p\", 0);\n    i0.ɵɵelementStart(13, \"p\");\n    i0.ɵɵtext(14);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(15, \"p\");\n    i0.ɵɵtext(16);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(17, \"p\");\n    i0.ɵɵtext(18);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(19, ApplicationRequestComponent_div_2_div_22_p_19_Template, 2, 0, \"p\", 0);\n    i0.ɵɵtemplate(20, ApplicationRequestComponent_div_2_div_22_button_20_Template, 2, 0, \"button\", 19);\n    i0.ɵɵelement(21, \"br\");\n    i0.ɵɵelementStart(22, \"label\", 20);\n    i0.ɵɵtext(23, \"Change Status\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(24, \"select\", 21);\n    i0.ɵɵlistener(\"ngModelChange\", function ApplicationRequestComponent_div_2_div_22_Template_select_ngModelChange_24_listener($event) {\n      i0.ɵɵrestoreView(_r13);\n      const ctx_r12 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r12.applicationRequest.applicationStatus = $event);\n    });\n    i0.ɵɵelementStart(25, \"option\", 22);\n    i0.ɵɵtext(26, \"Select a company\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(27, \"option\", 23);\n    i0.ɵɵtext(28, \"Approved\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(29, \"option\", 24);\n    i0.ɵɵtext(30, \"Rejected\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(31, \"button\", 25);\n    i0.ɵɵlistener(\"click\", function ApplicationRequestComponent_div_2_div_22_Template_button_click_31_listener() {\n      i0.ɵɵrestoreView(_r13);\n      const ctx_r14 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r14.updateApplicationStatus());\n    });\n    i0.ɵɵtext(32, \"Update\");\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const ctx_r4 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate1(\"User Name : \", ctx_r4.applicationRequest.username, \"\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"Official Email : \", ctx_r4.applicationRequest.officialEmail, \"\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"Phone Number : \", ctx_r4.applicationRequest.phoneNumber, \"\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"Designation : \", ctx_r4.applicationRequest.designation, \"\");\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r4.applicationRequest.roleId == 1);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r4.applicationRequest.roleId == 2);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"EmployeeId : \", ctx_r4.applicationRequest.employeeeId, \"\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"Aadhar Number : \", ctx_r4.applicationRequest.aadharNumber, \"\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"Company : \", ctx_r4.applicationRequest.companyId, \"\");\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r4.applicationRequest.licenseNo == null);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r4.applicationRequest.licenseNo != null);\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"ngModel\", ctx_r4.applicationRequest.applicationStatus);\n  }\n}\nfunction ApplicationRequestComponent_div_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\")(1, \"h2\", 10);\n    i0.ɵɵtext(2, \"Pending Application Requests\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"div\", 11)(4, \"div\", 12)(5, \"div\", 13)(6, \"table\", 14)(7, \"thead\")(8, \"tr\")(9, \"th\", 15);\n    i0.ɵɵtext(10, \"Name\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(11, \"th\", 15);\n    i0.ɵɵtext(12, \"OfficialMail\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(13, \"th\", 15);\n    i0.ɵɵtext(14, \"Phone Number\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(15, \"th\", 15);\n    i0.ɵɵtext(16, \"Company\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(17, \"th\", 15);\n    i0.ɵɵtext(18, \"Action\");\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(19, \"tbody\");\n    i0.ɵɵtemplate(20, ApplicationRequestComponent_div_2_tr_20_Template, 12, 7, \"tr\", 16);\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(21, \"div\", 17);\n    i0.ɵɵtemplate(22, ApplicationRequestComponent_div_2_div_22_Template, 33, 12, \"div\", 0);\n    i0.ɵɵelementEnd()()()();\n  }\n  if (rf & 2) {\n    const ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(20);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r2.applicationRequests);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", ctx_r2.applicationRequest);\n  }\n}\nexport let ApplicationRequestComponent = /*#__PURE__*/(() => {\n  class ApplicationRequestComponent {\n    constructor(router, route, apiService, tokenService) {\n      this.router = router;\n      this.route = route;\n      this.apiService = apiService;\n      this.tokenService = tokenService;\n      this.userhasrole = true;\n    }\n    ngOnInit() {\n      this.isLoading = true;\n      this.currentuserrole = this.tokenService.getRole();\n      this.isAutherised = this.tokenService.getToken() != null;\n      this.getPendingApplicationRequest();\n      console.log(this.tokenService.getname());\n      this.isLoading = false;\n      this.userhasrole = this.currentuserrole == 'SecurityHead';\n      console.log(this.userhasrole);\n      console.log(this.currentuserrole);\n      this.redrr();\n    }\n    redrr() {\n      if (!this.isAutherised) {\n        this.router.navigate(['/login'], {\n          queryParams: {\n            returnUrl: '/application-request'\n          }\n        });\n      }\n    }\n    selectRequest(request) {\n      this.applicationRequest = request;\n    }\n    getPendingApplicationRequest() {\n      if (this.isAutherised) {\n        this.apiService.getPendingApplications().subscribe(requests => {\n          this.applicationRequests = requests;\n        }, error => {\n          console.log(error);\n          if (this.tokenService.getRole() != \"SecurityHead\") {\n            this.userhasrole = false;\n            console.log(\"User Not Authorized\");\n          }\n        });\n      }\n    }\n    getApplicationByUserID(userId) {\n      this.apiService.getApplicationById(userId).subscribe(applicationRequest => {\n        this.applicationRequest = applicationRequest;\n        //     if(this.applicationRequest.licenseNo==null){\n        //       this.applicationRequest.licenseNo=\"\";\n        // this.applicationRequest.expirationDate=new Date;\n        // this.applicationRequest.rta=\"\";\n        // this.applicationRequest.alowedVehicles=;\n        //     }\n      }, error => {\n        console.log(error);\n      });\n    }\n    updateApplicationStatus() {\n      //this.applicationRequest.applicationStatus = status;\n      if (this.applicationRequest.expirationDate == null) {\n        this.applicationRequest.licenseNo = \"\";\n        this.applicationRequest.rta = \"\";\n        this.applicationRequest.alowedVehicles = \"\";\n        this.applicationRequest.expirationDate = new Date();\n      }\n      this.apiService.updateApplicationStatus(this.applicationRequest).subscribe(response => {\n        this.applicationRequest = null;\n        this.getPendingApplicationRequest();\n        console.log(response);\n        this.router.navigate(['/application-request']);\n      }, error => {\n        console.log(error);\n        if (error.status === 401) {\n          console.log(\"User Not Authorized\");\n        }\n      });\n    }\n  }\n  ApplicationRequestComponent.ɵfac = function ApplicationRequestComponent_Factory(t) {\n    return new (t || ApplicationRequestComponent)(i0.ɵɵdirectiveInject(i1.Router), i0.ɵɵdirectiveInject(i1.ActivatedRoute), i0.ɵɵdirectiveInject(i2.ApiService), i0.ɵɵdirectiveInject(i3.TokenService));\n  };\n  ApplicationRequestComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: ApplicationRequestComponent,\n    selectors: [[\"app-application-request\"]],\n    decls: 22,\n    vars: 7,\n    consts: [[4, \"ngIf\"], [\"id\", \"exampleModal\", \"tabindex\", \"-1\", \"role\", \"dialog\", \"aria-labelledby\", \"exampleModalLabel\", \"aria-hidden\", \"true\", 1, \"modal\", \"fade\"], [\"role\", \"document\", 1, \"modal-dialog\"], [1, \"modal-content\"], [1, \"modal-header\"], [\"id\", \"exampleModalLabel\", 1, \"modal-title\"], [\"type\", \"button\", \"id\", \"closeModal\", \"data-bs-dismiss\", \"modal\", \"aria-label\", \"Close\", 1, \"btn-close\"], [1, \"modal-body\"], [1, \"modal-footer\"], [\"type\", \"button\", \"data-dismiss\", \"modal\", 1, \"btn\", \"btn-secondary\"], [1, \"text-center\", \"mb-4\"], [1, \"container\"], [1, \"row\"], [1, \"col-md-6\", \"table-responsive\"], [1, \"table\", \"table-bordered\", \"table-hover\"], [\"scope\", \"col\"], [4, \"ngFor\", \"ngForOf\"], [1, \"col-md-6\"], [3, \"routerLink\", \"click\"], [\"type\", \"button\", \"class\", \"btn btn-primary\", \"data-toggle\", \"modal\", \"data-target\", \"#exampleModal\", 4, \"ngIf\"], [\"for\", \"status\"], [\"name\", \"status\", \"id\", \"status\", 1, \"form-control\", 3, \"ngModel\", \"ngModelChange\"], [\"value\", \"\"], [\"value\", \"Approved\"], [\"value\", \"Rejected\"], [1, \"btn\", \"btn-primary\", 3, \"click\"], [\"type\", \"button\", \"data-toggle\", \"modal\", \"data-target\", \"#exampleModal\", 1, \"btn\", \"btn-primary\"]],\n    template: function ApplicationRequestComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵtemplate(0, ApplicationRequestComponent_div_0_Template, 3, 0, \"div\", 0);\n        i0.ɵɵtemplate(1, ApplicationRequestComponent_div_1_Template, 3, 0, \"div\", 0);\n        i0.ɵɵtemplate(2, ApplicationRequestComponent_div_2_Template, 23, 2, \"div\", 0);\n        i0.ɵɵelementStart(3, \"div\", 1)(4, \"div\", 2)(5, \"div\", 3)(6, \"div\", 4)(7, \"h5\", 5);\n        i0.ɵɵtext(8, \"Driving License Details\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(9, \"button\", 6);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(10, \"div\", 7)(11, \"p\");\n        i0.ɵɵtext(12);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(13, \"p\");\n        i0.ɵɵtext(14);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(15, \"p\");\n        i0.ɵɵtext(16);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(17, \"p\");\n        i0.ɵɵtext(18);\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(19, \"div\", 8)(20, \"button\", 9);\n        i0.ɵɵtext(21, \"Close\");\n        i0.ɵɵelementEnd()()()()();\n      }\n      if (rf & 2) {\n        i0.ɵɵproperty(\"ngIf\", !ctx.isAutherised);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", !ctx.userhasrole && ctx.isAutherised);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.userhasrole && ctx.isAutherised);\n        i0.ɵɵadvance(10);\n        i0.ɵɵtextInterpolate1(\"License No : \", ctx.applicationRequest == null ? null : ctx.applicationRequest.licenseNo, \"\");\n        i0.ɵɵadvance(2);\n        i0.ɵɵtextInterpolate1(\"Expiration Date : \", ctx.applicationRequest == null ? null : ctx.applicationRequest.expirationDate, \"\");\n        i0.ɵɵadvance(2);\n        i0.ɵɵtextInterpolate1(\"RTA : \", ctx.applicationRequest == null ? null : ctx.applicationRequest.rta, \"\");\n        i0.ɵɵadvance(2);\n        i0.ɵɵtextInterpolate1(\"Allowed Vehicles : \", ctx.applicationRequest == null ? null : ctx.applicationRequest.alowedVehicles, \"\");\n      }\n    },\n    dependencies: [i4.NgForOf, i4.NgIf, i1.RouterLink, i5.NgSelectOption, i5.ɵNgSelectMultipleOption, i5.SelectControlValueAccessor, i5.NgControlStatus, i5.NgModel]\n  });\n  return ApplicationRequestComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}